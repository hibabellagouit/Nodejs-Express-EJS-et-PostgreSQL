<%- include('../../partials/header') %>
<%- include('../../partials/navigation') %>
<main class="container">
    <h1>Ajouter un livre</h1>

    <% if (typeof error !== 'undefined') { %>
        <div class="alert alert-error">
            <strong>Erreur :</strong> <%= error.message || error %>
        </div>
    <% } %>

    <div class="card">
        <form method="POST" action="/livres/ajouter">
            <div class="form-group">
                <label for="titre">Titre *</label>
                <input type="text" id="titre" name="titre" required value="<%= typeof livre !== 'undefined' ? livre.titre : '' %>">
            </div>

            <div class="form-group">
                <label for="auteur_id">Auteur *</label>
                <select id="auteur_id" name="auteur_id" required>
                    <option value="">Sélectionner un auteur</option>
                    <% if (typeof auteurs !== 'undefined') { auteurs.forEach(auteur => { %>
                        <option value="<%= auteur.id %>" <%= typeof livre !== 'undefined' && livre.auteur_id == auteur.id ? 'selected' : '' %>>
                            <%= auteur.prenom %> <%= auteur.nom %>
                        </option>
                    <% }); } %>
                </select>
            </div>

            <div class="form-group">
                <label for="isbn">ISBN</label>
                <input type="text" id="isbn" name="isbn" value="<%= typeof livre !== 'undefined' ? livre.isbn : '' %>">
            </div>

            <div class="form-group">
                <label for="annee_publication">Année de publication</label>
                <input type="number" id="annee_publication" name="annee_publication" min="1000" max="<%= new Date().getFullYear() + 1 %>" value="<%= typeof livre !== 'undefined' ? livre.annee_publication : '' %>">
            </div>

            <div class="form-group">
                <label for="genre">Genre</label>
                <input type="text" id="genre" name="genre" value="<%= typeof livre !== 'undefined' ? livre.genre : '' %>">
            </div>

            <div class="form-group">
                <label for="resume">Résumé</label>
                <textarea id="resume" name="resume" rows="5"><%= typeof livre !== 'undefined' ? livre.resume : '' %></textarea>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" name="disponible" <%= typeof livre !== 'undefined' && livre.disponible !== false ? 'checked' : 'checked' %>>
                    Disponible
                </label>
            </div>

            <div style="margin-top: 20px;">
                <button type="submit" class="btn btn-success">Ajouter</button>
                <a href="/livres" class="btn" style="margin-left: 10px;">Annuler</a>
            </div>
        </form>
    </div>
</main>
<%- include('../../partials/footer') %>